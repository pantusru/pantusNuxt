<template>
  <b-table-simple
    v-if="CartProduct.length > 0"
    class="text-center dropdown-cart d-none d-md-table"
  >
    <b-thead>
      <tr class="border-bottom">
        <th>
          Артикул <br />
          Наименование
        </th>
        <th>Цена</th>
        <th>Кол-во</th>
        <th>
          <nuxt-link
            to="/cart"
            class="bg-danger _baseBnt d-block btn text-white text-nowrap"
          >
            В корзину
          </nuxt-link>
        </th>
        <th />
      </tr>
    </b-thead>
    <b-tbody>
      <template v-for="(dataset, index) in CartProduct.slice(0, 5)">
        <tr :key="dataset.id">
          <td class="w-50 border-0" :rowspan="dataset.productOffer.length + 1">
            <nuxt-link class="text-body" to="/cart">
              <span
                class="reset-title reset-title-line-2 mb-1"
                :title="dataset.ProductCard.sku.original"
                >{{ dataset.ProductCard.sku.original }}
              </span>
              <span
                :title="dataset.ProductCard.name"
                class="reset-title reset-title-line-2"
                >{{ dataset.ProductCard.name }}
              </span>
            </nuxt-link>
          </td>
        </tr>
        <template v-for="offers in dataset.productOffer">
          <tr>
            <td class="border-0">
              <nuxt-link to="/cart" class="text-body"
                >{{ offers.prices }} Р
              </nuxt-link>
            </td>
            <td class="border-0">
              <nuxt-link to="/cart" class="text-body">
                {{ offers.Count }}
              </nuxt-link>
            </td>
            <td class="border-0">
              <DeleteCart
                :id="offers.id"
                :cart-product="dataset.productOffer"
                :index="index"
              />
            </td>
          </tr>
        </template>
      </template>
    </b-tbody>
  </b-table-simple>
</template>

<script>
import DeleteCart from "@/components/cart/button/cart-button-delete";
export default {
  name: "DropdownCart",
  components: {
    DeleteCart,
  },
  data() {
    return {
      fields: [
        { key: "sku", label: "Артикул" + "\r\n" + "Наименование" },
        { key: "price", label: "Цена" },
        { key: "count", label: "Кол-во, шт" },
        { key: "Delete", label: "" },
      ],
    };
  },
  computed: {
    CartProduct() {
      return this.$store.getters["Cart/CartAll/GetCartProduct"];
    },
  },
};
</script>

<style>
.dropdown-cart {
  padding: 20px;
  width: 400px;
  position: absolute;
  right: 0;
  z-index: 10;
  background-color: #fff;
}
.dropdown-cart th {
  border-top: 0 !important;
  border-bottom: 0 !important;
}
</style>

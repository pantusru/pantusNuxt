<template>
  <b-card
    class="h-100"
    header-class="bg-transparent border-0"
    footer-class="bg-transparent p-0 py-2 px-2"
    body-class="d-flex flex-column justify-content-between"
  >
    <template #header>
      <h6 class="mb-0 pr-1">
        <nuxt-link
          :title="datasetProduct.ProductCard.name"
          class="text-436174 text-decoration-none reset-title"
          :to="
            '/products/' +
            datasetProduct.ProductCard.id +
            '/' +
            datasetProduct.ProductCard.sku.normalized +
            '-' +
            datasetProduct.ProductCard.brand.code
          "
        >
          {{ datasetProduct.ProductCard.name }}
          <Chosen
            v-if="CheckUser"
            :id="datasetProduct.ProductCard.id"
            class-chosen="icons-chosen__blog"
            :link="datasetProduct"
          />
        </nuxt-link>
      </h6>
    </template>
    <ImgGetModal :product="datasetProduct" />
    <div class="mt-3">
      <product-element-row-get
        name="Бренд"
        :dataset="datasetProduct.ProductCard.brand.name"
        :link="'/search?filter_brands=' + datasetProduct.ProductCard.brand.id"
      />
      <product-element-row-get
        name="Артикул"
        :dataset="datasetProduct.ProductCard.sku.original"
        :link="
          '/search?filter_substr=' + datasetProduct.ProductCard.sku.original
        "
      />
      <product-element-row-get
        v-if="datasetProduct.ProductCard.ProductCardOem.length !== 0"
        name="OEM"
        :link="
          '/search?filter_substr=' +
          datasetProduct.ProductCard.ProductCardOem[0]
        "
        :dataset="datasetProduct.ProductCard.ProductCardOem[0]"
      />
      <product-element-row-get
        v-for="data in datasetProduct.ProductCard.ProductCardOem.slice(1, 4)"
        :key="data.id"
        :link="'/search?filter_substr=' + data"
        :dataset="data"
      />
    </div>
    <template v-if="datasetProduct.productOffer.length !== 0" #footer>
      <b-row no-gutters align-h="between" class="mt-1">
        <b-col>
          <div class="mb-3"><b class="fz-5">Цена</b></div>
          <div>
            <b class="fz-4">{{ datasetProduct.productOffer[0].prices }} Р</b>
          </div>
        </b-col>
        <b-col class="text-right d-flex flex-column justify-content-between">
          <availability-offers
            class="mb-2 fz-5_5"
            component="div"
            :link-offers="datasetProduct.productOffer[0]"
            :link-product="datasetProduct.ProductCard"
          />
          <BuyButton
            :link-offer="datasetProduct.productOffer[0]"
            :link-product="datasetProduct.ProductCard"
          />
        </b-col>
      </b-row>
    </template>
    <div v-if="datasetProduct.productOffer.length === 0">
      <span class="error fz-4">нет в продаже</span>
    </div>
  </b-card>
</template>

<script>
import Chosen from "@/components/metka/chosen"; // Метка избранный товар
import ImgGetModal from "@/components/products/product/element/img";
import BuyButton from "@/components/products/button/buy-index";
import ProductElementRowGet from "@/components/products/product/element/product-element-row-get";
import AvailabilityOffers from "@/components/products/product/element/availability-offers";
export default {
  name: "BlogProduct",
  components: {
    AvailabilityOffers,
    ProductElementRowGet,
    BuyButton,
    ImgGetModal,
    Chosen,
  },
  props: {
    datasetProduct: {},
  },
  computed: {
    CheckUser() {
      return this.$store.getters["User/CheckUser"];
    },
  },
};
</script>
